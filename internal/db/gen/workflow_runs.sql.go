// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: workflow_runs.sql

package dbgen

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createWorkflowRun = `-- name: CreateWorkflowRun :one
INSERT INTO workflow_runs (workflow_name, workflow_version, inputs, created_by, tags)
VALUES ($1, $2, $3, $4, $5)
RETURNING id, workflow_name, workflow_version, status, inputs, result, created_by, tags, created_at, started_at, completed_at, updated_at
`

type CreateWorkflowRunParams struct {
	WorkflowName    string      `json:"workflow_name"`
	WorkflowVersion pgtype.Text `json:"workflow_version"`
	Inputs          []byte      `json:"inputs"`
	CreatedBy       pgtype.Text `json:"created_by"`
	Tags            []byte      `json:"tags"`
}

func (q *Queries) CreateWorkflowRun(ctx context.Context, arg CreateWorkflowRunParams) (WorkflowRun, error) {
	row := q.db.QueryRow(ctx, createWorkflowRun,
		arg.WorkflowName,
		arg.WorkflowVersion,
		arg.Inputs,
		arg.CreatedBy,
		arg.Tags,
	)
	var i WorkflowRun
	err := row.Scan(
		&i.ID,
		&i.WorkflowName,
		&i.WorkflowVersion,
		&i.Status,
		&i.Inputs,
		&i.Result,
		&i.CreatedBy,
		&i.Tags,
		&i.CreatedAt,
		&i.StartedAt,
		&i.CompletedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getWorkflowRun = `-- name: GetWorkflowRun :one
SELECT id, workflow_name, workflow_version, status, inputs, result, created_by, tags, created_at, started_at, completed_at, updated_at FROM workflow_runs WHERE id = $1
`

func (q *Queries) GetWorkflowRun(ctx context.Context, id pgtype.UUID) (WorkflowRun, error) {
	row := q.db.QueryRow(ctx, getWorkflowRun, id)
	var i WorkflowRun
	err := row.Scan(
		&i.ID,
		&i.WorkflowName,
		&i.WorkflowVersion,
		&i.Status,
		&i.Inputs,
		&i.Result,
		&i.CreatedBy,
		&i.Tags,
		&i.CreatedAt,
		&i.StartedAt,
		&i.CompletedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateWorkflowRun = `-- name: UpdateWorkflowRun :one
UPDATE workflow_runs
SET status = COALESCE($2, status),
    result = COALESCE($3, result),
    started_at = COALESCE($4, started_at),
    completed_at = COALESCE($5, completed_at),
    updated_at = now()
WHERE id = $1
RETURNING id, workflow_name, workflow_version, status, inputs, result, created_by, tags, created_at, started_at, completed_at, updated_at
`

type UpdateWorkflowRunParams struct {
	ID          pgtype.UUID           `json:"id"`
	Status      NullWorkflowRunStatus `json:"status"`
	Result      []byte                `json:"result"`
	StartedAt   pgtype.Timestamptz    `json:"started_at"`
	CompletedAt pgtype.Timestamptz    `json:"completed_at"`
}

func (q *Queries) UpdateWorkflowRun(ctx context.Context, arg UpdateWorkflowRunParams) (WorkflowRun, error) {
	row := q.db.QueryRow(ctx, updateWorkflowRun,
		arg.ID,
		arg.Status,
		arg.Result,
		arg.StartedAt,
		arg.CompletedAt,
	)
	var i WorkflowRun
	err := row.Scan(
		&i.ID,
		&i.WorkflowName,
		&i.WorkflowVersion,
		&i.Status,
		&i.Inputs,
		&i.Result,
		&i.CreatedBy,
		&i.Tags,
		&i.CreatedAt,
		&i.StartedAt,
		&i.CompletedAt,
		&i.UpdatedAt,
	)
	return i, err
}
